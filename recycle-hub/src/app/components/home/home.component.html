<div class="home-container">
  <div class="collectes-section">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h2>Mes demandes de collecte</h2>
      <button class="btn btn-primary" routerLink="/add-collecte">
        <i class="fas fa-plus me-2"></i>
        Nouvelle collecte
      </button>
    </div>

    <div class="alert alert-danger" *ngIf="error">
      {{ error }}
    </div>

    <div class="loading-spinner" *ngIf="loading">
      Chargement...
    </div>

    <div class="table-responsive" *ngIf="!loading && collectes.length > 0">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Date</th>
            <th>Créneau</th>
            <th>Types de déchets</th>
            <th>Poids total</th>
            <th>Statut</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let collecte of collectes">
            <td>{{ collecte.dateCollecte | date:'dd/MM/yyyy' }}</td>
            <td>{{ collecte.creneauHoraire }}</td>
            <td>
              <span class="badge bg-secondary me-1" *ngFor="let dechet of collecte.dechets">
                {{ dechet.type }}
              </span>
            </td>
            <td>{{ collecte.poidsTotal }}g</td>
            <td>
              <span class="status-badge" [ngClass]="getStatusClass(collecte.statut)">
                {{ getStatusLabel(collecte.statut) }}
              </span>
            </td>
            <td>
              <button class="btn btn-sm btn-outline-primary me-2" 
                      *ngIf="collecte.statut === 'EN_ATTENTE'"
                      [routerLink]="['/edit-collecte', collecte.id]"
                      title="Modifier">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-sm btn-outline-danger"
                      *ngIf="collecte.statut === 'EN_ATTENTE'"
                      (click)="onDeleteCollecte(collecte.id)"
                      title="Supprimer">
                <i class="fas fa-trash-alt"></i>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="no-collectes" *ngIf="!loading && collectes.length === 0">
      <p>Vous n'avez pas encore de demandes de collecte.</p>
      <button class="btn btn-primary" routerLink="/add-collecte">
        Créer votre première demande
      </button>
    </div>
  </div>
</div>
